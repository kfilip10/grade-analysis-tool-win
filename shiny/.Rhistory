# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
roster.course <- roster_course_df()
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
roster.course <- roster_course_df()
#improves search down to the actual selected
df <- course_list_df() %>% filter(id %in% selected_courses()$id)
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
roster.course <- roster_course_df()
shiny::runApp()
#improves search down to the actual selected
df <- course_list_df() %>% filter(id %in% selected_courses()$id)
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
roster.course <- roster_course_df()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
#improves search down to the actual selected
df <- course_list_df() %>% filter(section_id %in% selected_courses()$section_id)
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
shiny::runApp()
#improves search down to the actual selected
df <- course_list_df() %>% filter(section_id %in% selected_courses()$section_id)
roster_course_df(
get_student_roster(df,
# message to user to select assignments
canvas_errorlist, INSTRUCTOR_SEARCH_KEY
))
shiny::runApp()
shiny::runApp()
force(course_df)
force(error_list)
force(instructor.search.key)
# error_list definition
enrollment.list <- lapply(unique(course_df$id), function(x, i) {
incProgress(1 / length(unique(course_df$id)))
tryCatch(
{
get_course_items(course_id = x, item = "enrollments", include = "current_points")
},
error = function(e) {
# Append error message to the reactive list
current_errors <- error_list
error_list(c(current_errors, list(paste("Error processing course ID:", x, "->", e$message))))
return(NULL) # Return NULL for failed courses
}
)
}, i = seq_along(course_df))
get_course_items(course_id = 9882, item = "enrollments", include = "current_points")
items <- get_course_items(course_id = 9882, item = "enrollments", include = "current_points")
shiny::runApp()
force(course_df)
items <- get_course_items(course_id = 9882, item = "enrollments", include = "current_points")
shiny::runApp()
shiny::runApp()
items <- get_course_items(course_id = 9882, item = "enrollments", include = "current_points")
shiny::runApp()
items <- get_course_items(course_id = 9882, item = "enrollments", include = "current_points")
View(items)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
colnames(cuts_df_filtered) <- c("V", "Q", "Name", "Pts", "Cut", "% Applied", "Question")
cuts_flextable <- flextable(cuts_df_filtered %>% select(`#`, Pts, Cut, `Applied (%)`)) %>%
theme_vanilla() %>%
bold(part = "header", bold = TRUE) %>% # Bold the headers
fontsize(size = 13, part = "all") %>% # Set font size for entire table
align(j = c("Question", "Cut"), align = "left", part = "all") %>% # Left-align the 'Cut' column
align(j = c("Pts", "% Applied"), align = "center", part = "all") %>%
autofit() %>%
padding(padding = 2.5, part = "all") %>%
height_all(height = 0.1, part = "all") #
cuts_flextable <- flextable(cuts_df_filtered %>% select(`Question`, Pts, Cut, `Applied (%)`)) %>%
theme_vanilla() %>%
bold(part = "header", bold = TRUE) %>% # Bold the headers
fontsize(size = 13, part = "all") %>% # Set font size for entire table
align(j = c("Question", "Cut"), align = "left", part = "all") %>% # Left-align the 'Cut' column
align(j = c("Pts", "% Applied"), align = "center", part = "all") %>%
autofit() %>%
padding(padding = 2.5, part = "all") %>%
height_all(height = 0.1, part = "all") #
cuts_flextable <- flextable(cuts_df_filtered %>% select(`Question`, Pts, Cut, `% Applied`)) %>%
theme_vanilla() %>%
bold(part = "header", bold = TRUE) %>% # Bold the headers
fontsize(size = 13, part = "all") %>% # Set font size for entire table
align(j = c("Question", "Cut"), align = "left", part = "all") %>% # Left-align the 'Cut' column
align(j = c("Pts", "% Applied"), align = "center", part = "all") %>%
autofit() %>%
padding(padding = 2.5, part = "all") %>%
height_all(height = 0.1, part = "all") #
return(cuts_flextable)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
force(df_canvas_adj)
View(df_canvas_adj)
### Pre/post table ----
pre_stats <- df_canvas_adj %>%
mutate(
pre_percent = pre_percent,
post_percent = post_percent,
mge_percent = mge_percent
) %>%
summarise(
Type = "Pre",
Number = n(),
Average = mean(pre_percent),
Median = median(pre_percent),
Min = min(pre_percent),
Max = max(pre_percent)
)
post_stats <- df_canvas_adj %>%
mutate(
post_percent = post_percent,
mge_percent = mge_percent
) %>%
summarise(
Type = "Post",
Number = n(),
Average = mean(post_percent),
Median = median(post_percent),
Min = min(post_percent),
Max = max(post_percent)
)
comp.stats <- rbind(pre_stats, post_stats)
comp_stats_ft <- comp.stats %>%
flextable() %>%
align_nottext_col(align = "center") %>%
fontsize(size = 16, part = "header") %>%
autofit() %>%
fontsize(size = 18) %>%
align_text_col(align = "center") %>%
colformat_double(digits = 1) %>%
set_caption(as_paragraph(
as_chunk("Pre/Post Score Comparisons", props = caption_style)
), word_stylename = "Table Caption")
# show(comp_stats_ft)
### table grades ----
grade_summary <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)), # Combine all unique grades
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)),
post_count = sapply(grades.desc, function(g) sum(post_grade == g))
) %>%
mutate(
percent_change = round((post_count - pre_count) / pre_count * 100, 0)
) %>%
mutate(grade = factor(grade, levels = grades)) %>%
arrange(grade)
colnames(grade_summary)[1] <- "Grade"
colnames(grade_summary)[2] <- "Pre Count"
colnames(grade_summary)[3] <- "Post Count"
colnames(grade_summary)[4] <- "Percent Change"
# Transpose the table
transposed_summary <- t(grade_summary)
colnames(transposed_summary) <- transposed_summary[1, ] # Set column names to the grades
transposed_summary <- transposed_summary[-1, , drop = FALSE] # Remove the first row used for column names
# Convert the transposed table to a data frame
transposed_df <- as.data.frame(transposed_summary, stringsAsFactors = FALSE)
# Add the row names as a column for `flextable`
transposed_df <- transposed_df %>%
rownames_to_column(var = "Grade")
# Create a color matrix for the transposed data frame
colormatrix <- apply(transposed_df[, -1], 1:2, function(x) {
if (!is.na(as.numeric(x))) { # Check if the value can be converted to numeric
ifelse(as.numeric(x) < 0, "#FDEFEF", "#F4FFEF") # Red for negative, green for positive
} else {
"#FFFFFF" # White for non-numeric cells
}
})
# writes the first two rows as white
colormatrix[1:2, ] <- "white"
colormatrix[3, 1] <- "white"
transposed_df[3, 1:ncol(transposed_df)] <- paste0(as.character(transposed_df[3, 1:ncol(transposed_df)]), "%")
# Apply the color matrix in a flextable
comp_grades_ft <- transposed_df %>%
flextable() %>%
bg(i = seq_len(nrow(transposed_df)), j = seq_len(ncol(transposed_df) - 1), bg = colormatrix) %>% # Apply colors
align_nottext_col(align = "center") %>%
align_text_col(align = "center") %>%
fontsize(size = 20, part = "header") %>%
fontsize(size = 18) %>%
set_caption(
as_paragraph(
as_chunk("Pre/Post Grade Comparisons", props = caption_style)
),
word_stylename = "Table Caption"
)
View(transposed_summary)
View(df_canvas_adj)
View(grade_summary)
df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)), # Combine all unique grades
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)),
post_count = sapply(grades.desc, function(g) sum(post_grade == g))
)
grades.desc
### table grades ----
grade_summary2 <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)))
View(grade_summary2)
### table grades ----
grade_summary2 <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)),
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)))
View(grade_summary2)
View(df_canvas_adj)
sum(grade_summary2$pre_count)
### table grades ----
grade_levels <- grades.desc
grade_summary2 <- tibble(
grade      = grade_levels,
pre_count  = sapply(grade_levels, \(g) sum(df_canvas_adj$pre_grade  == g, na.rm = TRUE)),
post_count = sapply(grade_levels, \(g) sum(df_canvas_adj$post_grade == g, na.rm = TRUE))
)
View(grade_summary2)
View(transposed_df)
grade_summary <- tibble(
grade      = grade_levels,
pre_count  = sapply(grade_levels, \(g) sum(df_canvas_adj$pre_grade  == g, na.rm = TRUE)),
post_count = sapply(grade_levels, \(g) sum(df_canvas_adj$post_grade == g, na.rm = TRUE))
)
View(grade_summary)
grade_summary2 <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)),
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)))
View(grade_summary2)
grade_summary2 <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)), # Combine all unique grades
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)),
post_count = sapply(grades.desc, function(g) sum(post_grade == g))
) %>%
mutate(
percent_change = round((post_count - pre_count) / pre_count * 100, 0)
) %>%
mutate(grade = factor(grade, levels = grades)) %>%
arrange(grade)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
### table grades ----
grade_levels <- rev(grades.desc)  # reverse to go F → A
grade_summary2 <- df_canvas_adj %>%
mutate(
pre_grade  = factor(pre_grade,  levels = grade_levels),
post_grade = factor(post_grade, levels = grade_levels)
) %>%
summarise(
pre_count  = tabulate(pre_grade,  nbins = length(grade_levels)),
post_count = tabulate(post_grade, nbins = length(grade_levels))
) %>%
as_tibble() %>%
mutate(
grade = grade_levels,
percent_change = 100 * (post_count - pre_count) / pmax(pre_count, 1)
) %>%
select(grade, pre_count, post_count, percent_change)
grade_summary <- df_canvas_adj %>%
mutate(
pre_grade  = factor(pre_grade,  levels = grade_levels),
post_grade = factor(post_grade, levels = grade_levels)
) %>%
summarise(
pre_count  = tabulate(pre_grade,  nbins = length(grade_levels)),
post_count = tabulate(post_grade, nbins = length(grade_levels))
) %>%
as_tibble() %>%
mutate(
grade = grade_levels,
percent_change = 100 * (post_count - pre_count) / pmax(pre_count, 1)
) %>%
select(grade, pre_count, post_count, percent_change)
grade_summary2 <- df_canvas_adj %>%
reframe(
grade = unique(c(pre_grade, post_grade)), # Combine all unique grades
pre_count = sapply(grades.desc, function(g) sum(pre_grade == g)),
post_count = sapply(grades.desc, function(g) sum(post_grade == g))
) %>%
mutate(
percent_change = round((post_count - pre_count) / pre_count * 100, 0)
) %>%
mutate(grade = factor(grade, levels = grades)) %>%
arrange(grade)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
View(grade_summary2)
View(grade_summary)
grade_summary <- df_canvas_adj %>%
mutate(
pre_grade  = factor(pre_grade,  levels = grade_levels),
post_grade = factor(post_grade, levels = grade_levels)
) %>%
summarise(
pre_count  = tabulate(pre_grade,  nbins = length(grade_levels)),
post_count = tabulate(post_grade, nbins = length(grade_levels))
) %>%
as_tibble() %>%
mutate(
grade = grade_levels,
percent_change = round(100 * (post_count - pre_count) / pmax(pre_count, 1),0)
) %>%
select(grade, pre_count, post_count, percent_change)
grade_summary <- df_canvas_adj %>%
mutate(
pre_grade  = factor(pre_grade,  levels = grade_levels),
post_grade = factor(post_grade, levels = grade_levels)
) %>%
reframe(
pre_count  = tabulate(pre_grade,  nbins = length(grade_levels)),
post_count = tabulate(post_grade, nbins = length(grade_levels))
) %>%
as_tibble() %>%
mutate(
grade = grade_levels,
percent_change = round(100 * (post_count - pre_count) / pmax(pre_count, 1),0)
) %>%
select(grade, pre_count, post_count, percent_change)
View(grade_summary)
shiny::runApp()
install.packages(req.txt)
#set
# Read package names from req.txt
packages <- readLines("req.txt")
# This code installs R packages on the local machine for debugging purposes.
# This does not package with the installer. That is done through the 'add-cran-binary-pkgs.R' script.
#set workspace to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Read package names from req.txt
packages <- readLines("req.txt")
# Remove empty lines and trim whitespace
packages <- trimws(packages[packages != ""])
# Get currently installed packages
installed <- rownames(installed.packages())
# Determine which packages need to be installed
to_install <- packages[!packages %in% installed]
# Install missing packages
if (length(to_install) > 0) {
cat("Installing packages:", paste(to_install, collapse = ", "), "\n")
install.packages(to_install, dependencies = TRUE)
} else {
cat("All packages are already installed.\n")
}
# Verify installation
cat("\nVerifying installation...\n")
for (pkg in packages) {
if (require(pkg, character.only = TRUE, quietly = TRUE)) {
cat("✓", pkg, "\n")
} else {
cat("✗", pkg, "FAILED\n")
}
}
runApp()
runApp()
install.packages('keyring')
runApp()
runApp()
runApp()
# Make the slide
ppt <- add_slide(ppt, layout = "question", master = "Office Theme")
ppt <- ph_with(ppt,
value = str_c(question_group_name),
location = ph_location_label(ph_label = "Title")
)
### a. Score PDF ----
# score PDF distribution: make and add (Bottom LEFT)
q.pdf.plot <- plot_question(question_df)
padding <- 0.125
left_top_start <- 3.5
left_width <- 6
right_top_start <- 0.1
right_col_start <- 6 + 2 * padding # from the left of the slide (in)
right_width <- 8 - padding
plot_height <- 3.75
ppt <- ph_with(ppt,
value = q.pdf.plot,
location = ph_location(
left = right_col_start, top = right_top_start,
width = right_width,
height = plot_height
)
)
### b. Grades Histo ----
# TODO: Add grades histogram, below should work in the app
# grades histogram: Make and add (TOP LEFT)
grades_table_ft <- question_grades_table(question_df)
dims <- dim_pretty(grades_table_ft)
grades_table_height <- sum(dims$heights)
grades_table_width <- sum(dims$width)
grades_table_start <- left_top_start + plot_height + padding
ppt <- ph_with(ppt,
value = grades_table_ft,
location = ph_location(
left = 0.05, top = left_top_start,
width = left_width,
height = grades_table_height
)
)
sum_flexTable <- summary_table_question(question_df)
sum_flextable <- sum_flexTable %>% width(width = left_width)
dims <- dim_pretty(sum_flexTable)
sum_flex_table_height <- sum(dims$heights)
sum_flex_table_width <- sum(dims$width)
flex_table_start <- left_top_start + grades_table_height + 6 * padding
ppt <- ph_with(ppt,
value = sum_flexTable,
location = ph_location(
left = 0.05 + (left_width - sum_flex_table_width - .6) / 2,
top = flex_table_start,
# width=left_width,
height = sum_flex_table_height
)
)
### d. Cuts Table ----
# get the questoin names in the group
# cut_filter_threshold = 0.15
cuts_flextable <- cuts_table(question_df, cuts_df, cut_filter_threshold)
ppt <- ph_with(ppt,
value = cuts_flextable,
location = ph_location(
left = right_col_start,
top = right_top_start + plot_height + padding,
width = right_width
)
)
return(ppt)
print(ppt)
print(ppt, target="draft")
print(ppt, target="draft.pptx")
runApp()
runApp()
runApp()
# clean question+list and cut list of underscores
# remove understores from all the question in cuts_df
cuts_df$question <- gsub("_", " ", cuts_df$question)
View(cuts_df)
version_palette <- setNames(version_palette, unique(df_canvas_adj$version))
# browser()
# df = question_list[[1]]
# Check if input is a named list of dataframes
if (!is.list(question_list) || is.null(names(question_list))) {
stop("Input must be a named list of dataframes.")
}
## 1a. Title ----
incProgress(1 / progress.tot, detail = paste("Making Title Slide"))
ppt <- ppt_init(courseTitle, eventTitle)
# browser()
## 1b. Pre/post ----
incProgress(1 / progress.tot, detail = paste("Making Pre/Post Slide"))
ppt <- ppt_prepost(ppt, df_canvas_adj)
## 1c. Pre-score population comparison ----
incProgress(1 / progress.tot, detail = paste("Making Pre/Post Slide"))
ppt <- ppt_prescorepop(ppt, df_canvas_adj)
ppt <- ppt_makeupcadets(ppt, missing_roster)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
